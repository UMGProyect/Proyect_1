@model Proyect_1.Models.UserProfileViewModel

@{
    ViewData["Title"] = "Perfil";
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@Model.UserName - Perfil</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://kit.fontawesome.com/a076d05399.js"></script> <!-- Cargar la librería de Font Awesome -->
</head>
<body>
    <!-- Menú de navegación superior -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
        <a class="navbar-brand" href="#"><i class="fas fa-users fa-2x text-primary"></i></a>
        <form class="form-inline my-2 my-lg-0 mx-auto">
            <input class="form-control mr-sm-2" type="search" placeholder="Buscar" aria-label="Search">
        </form>
        <div class="navbar-nav">
            <a class="nav-link" href="#"><i class="fas fa-home"></i> Inicio</a>
            <a class="nav-link" href="#"><i class="fas fa-user-friends"></i> Amigos</a>
            <a class="nav-link" href="#"><i class="fas fa-envelope"></i> Mensajes</a>
            <a class="nav-link" href="#"><i class="fas fa-bell"></i> Notificaciones</a>
        </div>
    </nav>

    <div class="container-fluid p-0">
        <!-- Banner de usuario -->
        <!-- Formulario para el Banner y la Imagen de Perfil -->
        <form asp-action="EditarPerfil" method="post" enctype="multipart/form-data">
            <!-- Banner de usuario -->
            <div class="banner" style="background-image: url('@Model.BannerImageUrl'); height: 300px; background-size: cover; position: relative;">
                <input type="file" name="bannerFile" id="banner-image-upload" style="display: none;" accept="image/*" onchange="this.form.submit();">
                <label for="banner-image-upload" style="cursor: pointer; height: 100%; width: 100%; display: block;">
                    <div class="overlay" style="height: 100%; width: 100%; position: absolute; background: rgba(0, 0, 0, 0.3);"></div>
                </label>
            </div>

            <!-- Sección para la imagen del perfil -->
            <div class="profile-picture-container" style="position: relative;">
                <input type="file" name="profilePictureFile" id="profile-image-upload" style="display: none;" accept="image/*" onchange="this.form.submit();">
                <label for="profile-image-upload" style="cursor: pointer;">
                    <img src="@Model.ProfilePictureUrl" alt="@Model.UserName" class="profile-picture rounded-circle" style="width: 150px; border: 5px solid white;">
                </label>
            </div>
        </form>



        <div class="container mt-5">
            <div class="row">
                <!-- Columna izquierda (Información del perfil) -->
                <div class="col-md-3 text-center">
                    <h2 class="mt-3">@Model.UserName</h2>
                    <p>@Model.Bio</p>
                    <!-- Botones de acción -->
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-primary"><i class="fas fa-user-plus"></i> Agregar amigo</button>
                        <button type="button" class="btn btn-outline-secondary"><i class="fas fa-envelope"></i> Mensaje</button>
                    </div>
                    <button type="button" class="btn btn-outline-secondary mt-2"><i class="fas fa-user-check"></i> Seguir</button>

                    <!-- Amigos -->
                    <div class="mt-4">
                        <h4>Amigos</h4>
                        <div class="d-flex justify-content-around flex-wrap">
                            <div>
                                <img src="https://via.placeholder.com/50" alt="Amigo" class="rounded-circle">
                                <p>Amigo 1</p>
                            </div>
                            <div>
                                <img src="https://via.placeholder.com/50" alt="Amigo" class="rounded-circle">
                                <p>Amigo 2</p>
                            </div>
                            <div>
                                <img src="https://via.placeholder.com/50" alt="Amigo" class="rounded-circle">
                                <p>Amigo 3</p>
                            </div>
                            <div>
                                <img src="https://via.placeholder.com/50" alt="Amigo" class="rounded-circle">
                                <p>Amigo 4</p>
                            </div>
                        </div>
                        <a href="#" class="btn btn-link">Ver todos los amigos</a>
                    </div>
                </div>

                <!-- Columna derecha (Publicaciones) -->
                <form asp-action="CrearPublicacion" method="post" enctype="multipart/form-data">
                    <div class="col-md-9">
                        <div class="card">
                            <div class="card-body">
                                <input type="text" name="title" class="form-control" placeholder="Título" required />
                                <textarea name="content" class="form-control mt-2" placeholder="¿Qué estás pensando?" rows="2" required></textarea>
                                <div class="d-flex justify-content-between mt-2">
                                    <div>
                                        <button type="button" class="btn btn-link" id="btn-upload-photo">
                                            <i class="fas fa-camera"></i> Foto/Video
                                        </button>
                                        <button type="button" class="btn btn-link"><i class="fas fa-smile"></i> Sentimiento</button>
                                        <input type="file" name="mediaFile" id="file-upload" style="display: none;">
                                    </div>
                                    <button type="submit" class="btn btn-primary">Publicar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>



                <!-- Publicaciones del usuario -->
                @foreach (var post in Model.Posts)
                {
                    <div class="card mt-4">
                        <div class="card-body">
                            <h5 class="card-title">@post.Title</h5>
                            <p class="card-text">@post.Content</p>
                            @if (!string.IsNullOrEmpty(post.ImageUrl))
                            {
                                <img src="@post.ImageUrl" alt="Imagen de la publicación" class="post-image img-fluid mb-3">
                            }
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-muted">Publicado el @post.CreatedAt.ToString("dd/MM/yyyy")</small>
                                <div>
                                    <span class="reaction-btn mr-3"><i class="far fa-thumbs-up"></i> Me gusta (@post.Likes)</span>
                                    <span class="reaction-btn mr-3"><i class="far fa-comment"></i> Comentarios (@post.Comments.Count)</span>
                                    <span class="reaction-btn"><i class="fas fa-share"></i> Compartir</span>
                                </div>
                            </div>
                            <hr>
                            <!-- Comentarios -->
                            <h6>Comentarios:</h6>
                            @foreach (var comment in post.Comments)
                            {
                                <div class="mb-2">
                                    <strong>@comment.UserName</strong>: @comment.Content
                                </div>
                            }
                            <!-- Caja para añadir comentario -->
                            <div class="mt-3">
                                <textarea class="form-control comment-box" rows="1" placeholder="Escribe un comentario..."></textarea>
                                <button class="btn btn-primary btn-sm mt-2">Comentar</button>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
    </div>



    <script>
        document.getElementById('btn-upload-photo').addEventListener('click', function () {
            document.getElementById('file-upload').click();
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Muestra el contenedor del botón cuando la página se haya cargado
            document.getElementById("buttonContainer").style.display = "block";
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
